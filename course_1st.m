
x = [0.0000000e+00, 1.0000000e+00, 2.0000000e+00, 3.0000000e+00, 4.0000000e+00, 5.0000000e+00, 6.0000000e+00, 7.0000000e+00, 8.0000000e+00, 9.0000000e+00, 1.0000000e+01, 1.1000000e+01, 1.2000000e+01, 1.3000000e+01, 1.4000000e+01, 1.5000000e+01, 1.6000000e+01, 1.7000000e+01, 1.8000000e+01, 1.9000000e+01, 2.0000000e+01, 2.1000000e+01, 2.2000000e+01, 2.3000000e+01, 2.4000000e+01, 2.5000000e+01, 2.6000000e+01, 2.7000000e+01, 2.8000000e+01, 2.9000000e+01, 3.0000000e+01, 3.1000000e+01, 3.2000000e+01, 3.3000000e+01, 3.4000000e+01, 3.5000000e+01, 3.6000000e+01, 3.7000000e+01, 3.8000000e+01, 3.9000000e+01, 4.0000000e+01, 4.1000000e+01, 4.2000000e+01, 4.3000000e+01, 4.4000000e+01, 4.5000000e+01, 4.6000000e+01, 4.7000000e+01, 4.8000000e+01, 4.9000000e+01, 5.0000000e+01];
y = [7.5273400e-02,6.8382599e-01,4.9721066e-01,1.2429722e+00,1.3687247e+00,1.2166209e+00,1.2811569e+00,1.2040664e+00,1.3610995e+00,8.6987204e-01,-1.3077124e-01,5.3614681e-02,-6.6381087e-01,-1.0953233e+00,-1.2039811e+00,-1.4259715e+00,-1.3746812e+00,-9.7937269e-01,-7.0804611e-01,-3.3797870e-01,-2.2315565e-02,1.4577675e-01,8.1637526e-01,1.2770770e+00,1.3501821e+00,1.5372953e+00,1.4721584e+00,1.1752252e+00,9.9007401e-01,4.7947305e-01,2.9861158e-01,-4.1842051e-01,-8.1495970e-01,-1.1227081e+00,-1.6694117e+00,-1.1838186e+00,-1.3355909e+00,-1.3510673e+00,-7.9906991e-01,-8.8159195e-01,-2.4615979e-01,1.6658790e-01,6.5821197e-01,1.0119669e+00,1.1094290e+00,1.3713423e+00,1.3663686e+00,1.3587725e+00,1.1842346e+00,8.4845449e-01,1.6814308e-01];

% f = 2*sin(0.3195*x);
% plot(x, y, 'o', x, f)


w=0:0.001:0.5;
F=zeros(1,length(w));
W = 0;
for k=1:length(w)
    s1=sum(y.*sin(w(k).*x));
    s2=sum((sin(w(k).*x)).^2);
    s3=sum(y.*cos(w(k).*x));
    s4=sum(sin(w(k).*x).*cos(w(k).*x));
    F(k)=(s1*s4-s2*s3)-50;
    for l = 1:length(w)-1
        if W == 0
            if F(l)*F(l+1) < 0
                W = (w(l)+w(l+1))/2;
            end
        end
    end
%plot(w,F);
hold on
%z = w.*0;
% plot(w, z)
end

s12 = sum(y.*sin(W.*x));
s22 = sum(sin(W.*x).^2);
A = s12/s22;

x_true = 0:0.01:50;
y_true = A*sin(W.*x_true);
plot(x,y, 'o', x_true,y_true)



